# HTTP协议那些事

## http请求模型
### 客户端，服务器
* Client -> 请求(request) -> Server
* Server -> 响应(response) -> Client
* 不会影响数据，除非劫持

## 浏览器行为与http协议
### 处理过程
1. 输入网址并回车
2. 解析域名
3. 浏览器发送http请求
4. 服务器处理请求
5. 服务器返回html响应
6. 浏览器处理html页面
7. 继续请求其他资源

### 处理流程2
1. 浏览器接收到请求

2. 局域网通过防火墙（控制数据包进出的设备，网络边界）和路由器或者是代理服务器等设备走通外网
> 防火墙
>> 防火墙有软和硬，硬件防火墙相当于一辆高配宝马
>> 防火墙就是一个对数据包的一个发送和接收的策略，什么样的包可以出，什么样的包可以进，专门管策略的一层壳，调用linux内核的网络功能（linux六大系统之一的网络子系统的核心功能）
> 路由器功能
>> 家用路由，负责和电信那边的tcp服务器进行联系（硬件链路）

3. DNS解析（域名解析）
> dns的IP地址实际上是内置到电脑里面的，只要计算机获取到ip地址，同时也会把dns服务器的IP地址获取到
> 路由器是网络上的透明路由器
> 如何获取到路由器(不能加协议) => centos
>> `traceroute www.baidu.com`
>> centos下如果出现-bash: traceroute: 未找到命令，要先安装
`yum install traceroute -y`
>> 如果不能探查到的用出现* * * 
>> 因为在使用traceroute的时候，实际上是发送ping包<br />
ping包中icmp_seq指包的数列号（链路层协议），ttl是指计数器（window默认大小是52），每经过一个路由ttl会减1，一直减到0，这个包会被路由器扔掉，意味着，这个包在网络上传输的时间太久了，陷入了一个死循环(ttl默认值-当前ttl为跨过的路由器数量)
>>> windows下是
`tracert www.baidu.com`

4. tcp/ip协议链路问题

5. 到http服务器机房，一棵树（集群），树上鸟就是服务器，这棵树只有一个出入口（ip地址），请求进去了，还会有一个反向代理，根据你请求头上的东西，决定分发到哪只鸟（服务器）上去

6. 到了一只鸟（服务）上，服务器要做出反应（响应），数据再回去（和来的路不一样），浏览器收到数据，浏览器处理数据（性能优化[缓存，dom解析，渲染，脚本和事件的绑定等等]）


## 什么是http
* http是超文本传输协议，从www浏览器传输到本地浏览器的一种传输协议
* http协议是由客户端到服务器的请求（request）和从服务器到客户机的响应（response）进行约束和规范

## TCP/IP协议栈（iso/osi协议）
1. 应用层
	* 应用层，表示层，会话层
> 为用户提供所需的各种服务（http,ftp,dns,smtp,ssh....）直接和应用程序打交道
2. 传输层
> 为应用层实体提供端对端的通信功能，保证数据包的顺序传送及数据的完整性
> 该层定义了两个主要的协议：传输控制协议（TCP）和用户数据报协议（UDP）
3. 网络层
> 主要解决主机到主机的通信问题，ip协议是网络互联网最重要的协议
>> ping,traceroute(tracert)
4. 网络接口层
	* 数据链路层，物理层(网卡，路由器)
> 负责监视数据在主机和网络之间的交换

## TCP/IP协议栈中的位置
* 目前普遍应用版本HTTP 1.1
* 正在逐步向HTTP 2 迁徙
* HTTP默认端口80
* HTTPS默认端口443
>> https就是在http中加了一块加密模块（TLS、SSL）

## HTTP的工作过程(重点)
* 一次HTTP操作成为一个__事务__，其工作过程可分为四步
> 事务：一个操作假如有若干个有序操作，必须严格按照顺序操作，只要其中任何一个过程或者顺序出了错误，就算所有的操作执行失败，假如这个操作有这样的性质，就是事务
1. 首先客户机与服务器需要建立连接。只要单击某个超链接（TCP），http工作开始。
2. 建立连接后，客户机发送一个请求给服务器，请求方式的格式为：统一资源标识符（url）、协议版本号，后面是MIME信息包括请求修饰符、客户机信息和可能的内容。
3. 服务器接收到请求后，给予相应的相应信息，其格式为一个状态行，包括信息的协议版本号、一个成功或错误的代码，后面是MIME信息包括服务器信息，实体信息和可能的内容
4. 客户端接收服务器所返回的信息通过浏览器显示在用户的显示屏上，然后客户机与服务器断开连接（TCP连接）
> * 如果以上过程中的某一步出现错误，那么产生的错误信息将返回到客户端，有显示屏输出。对于用户来说，这些过程是由HTTP自己完成的，用户只要用鼠标点击，等待信息显示就可以了

## 请求与响应
* HTTP请求组成：请求行、消息报头、请求正文
* HTTP响应组成：状态行、消息报头、响应正文
* 请求行组成：以一个方法符号开头，后面跟着请求的URI和协议的版本
* 状态行组成：服务器HTTP协议的版本，服务器发挥的响应状态代码和状态代码的文本描述

## 请求方法（8个）
* get/post/put/delete(增删改查最重要)
* GET：请求获取request-uri所标识的资源
* POST：在request-uri所标识的资源后附加新的数据
* HEAD：请求获取由request-uri所标识的资源的响应消息报头
* PUT：请求服务器存储一个资源，并用request-uri作为其标识
* DELETE：请求服务器删除request-uri所标识的资源
* TRACE：请求服务器回送收到的请求信息，主要用于测试或诊断
* CONNECT：HTTP/1.1协议中预留给能够将连接改为管道方式的代理服务器
* OPTIONS：请求查询服务器性能，或者查询与资源相关的选项和需求

## HTTP状态码
__状态码有三位数字组成，第一个数字定义了响应的类别__
* 1xx：指示信息--表示请求已接收，继续处理
* 2xx：成功--表示请求已被成功接收、理解、接受
* 3xx：重定向--要完成请求必须进行更进一步操作
* 4xx：客户端错误--请求有语法错误或请求无法实现
* 5xx：服务器端错误--服务器未能实现合法的请求

## HTTP2协议分析


## cookie和session
### cookie
* Cookie是保存在客户端的小段文本，随客户端每一个请求发送该url下的所有cookies到服务器端
> ASCII码
### session
* Session则保存在服务器端，通过唯一的值sessionID来区别每一个用户，sessionID随每个连接请求发送到服务器，服务器根据sessionID来识别客户端，再通过session的key获取session值
> 理解成数据库，用来维持会话
> http是无状态


## 